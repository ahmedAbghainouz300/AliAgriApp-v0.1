<div class="fournisseurs-container" *ngIf="!showingDetails">
    <!-- Search and Add Section -->
    <div class="fournisseurs-header">
        <div class="fournisseur-image"><img [src]="imagePath" alt="Payment"></div>
        <div style=" flex:0.5;">
            <mat-select [(ngModel)]="actionneur" (selectionChange)="ngOnInit()">
                <mat-option *ngFor="let actionneur of actionneurs" [value]="actionneur">
                    {{ actionneur }}
                </mat-option>
            </mat-select>
        </div>
        <div class="formdiv">
            <mat-form-field appearance="outline" class="matformfield">
                <mat-label>Search</mat-label>
                <input matInput [(ngModel)]="searchTerm" (keyup)="filterchange()" />
            </mat-form-field>
        </div>
    </div>
    <mat-divider style="margin: 10px 0;"></mat-divider>
    <div class="mat-elevation-z8 fournisseurs-table-container">
        <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8 fournisseurs-table">
            <!-- Columns Definition -->
            <ng-container matColumnDef="no">
                <th mat-header-cell *matHeaderCellDef class="bordered-cell"> NO </th>
                <td mat-cell *matCellDef="let payment" class="bordered-cell">
                    {{ payements.indexOf(payment) + 1 }}
                </td>
            </ng-container>

            <ng-container matColumnDef="date">
                <th mat-header-cell *matHeaderCellDef class="bordered-cell"> Date de payement </th>
                <td mat-cell *matCellDef="let payment" class="bordered-cell">
                    {{payment.datePayement | date: 'y-MM-dd' }}
                </td>
            </ng-container>

            <ng-container matColumnDef="actionneur">
                <div *ngIf="actionneur === 'client'">
                     <th mat-header-cell *matHeaderCellDef class="bordered-cell"> Client </th>
                <td mat-cell *matCellDef="let payment" class="bordered-cell">
                    {{getClientById(payment.clientId) || 'N/A'}}
                </td>
                </div>
                <div *ngIf="actionneur === 'fournisseur'">
                    <th mat-header-cell *matHeaderCellDef class="bordered-cell"> Fournisseur </th>
               <td mat-cell *matCellDef="let payment" class="bordered-cell">
                   {{getClientById(payment.fournisseurId) || 'N/A'}}
               </td>
               </div>
            </ng-container>

            <ng-container matColumnDef="montant">
                <th mat-header-cell *matHeaderCellDef class="bordered-cell"> Montant </th>
                <td mat-cell *matCellDef="let payment" class="bordered-cell">
                    {{payment.montant | currency}}
                </td>
            </ng-container>

            <ng-container matColumnDef="option">
                <th mat-header-cell *matHeaderCellDef class="bordered-cell"> Options </th>
                <td mat-cell *matCellDef="let payment" class="bordered-cell">
                    <button type="button" class="btn btn-outline-danger btn-sm" (click)="deletePayement(payment);showingDetails=false">
                        <i class="bi bi-trash3-fill"></i> Supprimer
                    </button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row (click)="showDetails(row)" *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>

        <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" showFirstLastButtons></mat-paginator>
    </div>

</div>
<div>
    <button mat-fab (click)="showingDetails = false">
        <i class="bi bi-arrow-return-left"></i>
    </button>
    <div class="second-container" *ngIf="showingDetails">
    
    <div class="details-header">
        <h2>Payement {{actionneur.toLocaleUpperCase()}}</h2>
        <h5 *ngIf="actionneur ==='client'">Par : {{ getClientById(detailledpayement.clientId) }}</h5>
        <h5 *ngIf="actionneur ==='fournisseur'">Par : {{ getClientById(detailledpayement.fournisseurId) }}</h5>
        <p>Le : {{ detailledpayement.datePayement | date:'fullDate' }}</p>
    </div>

    <h3>Montant = {{detailledpayement.montant | rightCurrency}}</h3>
    <style>
        .second-container {
            width: 148mm;
            height: 210mm;
            padding: 15mm;
            border: 1px solid #ddd;
            margin: 20px auto;
            box-shadow: 0 0 8px rgba(0, 0, 0, 0.1);
            background-color: white;
            display: flex;
            flex-direction: column;
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
        }

        .details-header {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-start;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }

        .details-header h2 {
            margin: 0;
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }

        .details-header h5 {
            margin: 5px 0 0 0;
            font-size: 1.2em;
            color: #555;
        }

        .details-header p {
            margin: 5px 0 0 0;
            font-size: 1em;
            color: #777;
        }

        h3 {
            margin-top: 20px;
            font-size: 1.3em;
            font-weight: normal;
            color: #333;
        }

        button {
            align-self: flex-start;
            margin-bottom: 20px;
        }

        .bi {
            margin-right: 5px;
        }

        @media print {
            .second-container {
                box-shadow: none;
                margin: 0;
                width: 148mm;
                height: 210mm;
                padding: 10mm;
                border: none;
            }
        }
    </style>
</div>
</div>
